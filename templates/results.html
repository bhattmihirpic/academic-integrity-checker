{% extends "base.html" %}

{% block title %}Analysis Results - Academic Integrity Checker Tool 2.0 - {{ analysis.filename }}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <!-- Header with file info -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h2><i class="fas fa-chart-line me-2"></i>Analysis Results</h2>
                <p class="text-muted mb-0">
                    <i class="fas fa-file-alt me-1"></i> {{ analysis.filename }} 
                    <span class="mx-2">â€¢</span>
                    <i class="fas fa-calendar me-1"></i> {{ analysis.timestamp.strftime('%B %d, %Y at %I:%M %p') }}
                </p>
            </div>
            <div>
                <a href="{{ url_for('home_page') }}" class="btn btn-primary me-2">
                    <i class="fas fa-plus"></i> New Analysis
                </a>
            </div>
        </div>

        <!-- Main score cards -->
        <div class="row mb-4">
            <!-- Plagiarism score card -->
            <div class="col-md-6">
                <div class="card analysis-card border-warning">
                    <div class="card-header bg-warning text-dark">
                        <h5 class="mb-0">
                            <i class="fas fa-copy me-2"></i>Plagiarism Analysis
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="fs-6">Similarity Score:</span>
                            <span class="fs-3 similarity-{{ 'high' if plagiarism_result.overall_score > 70 else 'medium' if plagiarism_result.overall_score > 40 else 'low' }}">
                                {{ "%.1f"|format(plagiarism_result.overall_score) }}%
                            </span>
                        </div>
                        
                        <!-- Progress bar -->
                        <div class="progress progress-custom mb-3">
                            <div class="progress-bar 
                                {{ 'bg-danger' if plagiarism_result.overall_score > 70 else 'bg-warning' if plagiarism_result.overall_score > 40 else 'bg-success' }}" 
                                style="width: {{ plagiarism_result.overall_score }}%">
                            </div>
                        </div>
                        

                    </div>
                </div>
            </div>
            
            <!-- AI detection score card -->
            <div class="col-md-6">
                <div class="card analysis-card border-dark">
                    <div class="card-header bg-dark text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-robot me-2"></i>AI Content Detection
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="fs-6">AI Probability:</span>
                            <span class="fs-3 similarity-{{ 'high' if ai_result.ai_probability > 70 else 'medium' if ai_result.ai_probability > 40 else 'low' }}">
                                {{ "%.1f"|format(ai_result.ai_probability) }}%
                            </span>
                        </div>
                        
                        <!-- Progress bar -->
                        <div class="progress progress-custom mb-3">
                            <div class="progress-bar 
                                {{ 'bg-danger' if ai_result.ai_probability > 70 else 'bg-warning' if ai_result.ai_probability > 40 else 'bg-success' }}" 
                                style="width: {{ ai_result.ai_probability }}%">
                            </div>
                        </div>
                        

                    </div>
                </div>
            </div>
        </div>

        <!-- Document Analysis -->
        <div class="card analysis-card mb-4">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-chart-bar me-2"></i>Content Analysis
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- Text Statistics -->
                    <div class="col-md-4">
                        <h6 class="border-bottom pb-2 mb-3">Text Statistics</h6>
                        <div class="mb-2">
                            <small class="text-muted">Total Words:</small><br>
                            <strong>{{ text_stats.get('total_words', 'N/A') }}</strong>
                        </div>
                        <div class="mb-2">
                            <small class="text-muted">Total Sentences:</small><br>
                            <strong>{{ text_stats.get('total_sentences', 'N/A') }}</strong>
                        </div>
                        <div class="mb-2">
                            <small class="text-muted">Unique Words:</small><br>
                            <strong>{{ text_stats.get('unique_words', 'N/A') }}</strong>
                        </div>
                    </div>
                    
                    <!-- Complexity Analysis -->
                    <div class="col-md-4">
                        <h6 class="border-bottom pb-2 mb-3">Text Complexity</h6>
                        <div class="mb-2">
                            <small class="text-muted">Average Word Length:</small><br>
                            <strong>{{ text_stats.get('avg_word_length', 'N/A') }} characters</strong>
                        </div>
                        <div class="mb-2">
                            <small class="text-muted">Average Sentence Length:</small><br>
                            <strong>{{ text_stats.get('avg_sentence_length', 'N/A') }} words</strong>
                        </div>
                        <div class="mb-2">
                            <small class="text-muted">Vocabulary Richness:</small><br>
                            <strong>{{ text_stats.get('vocabulary_richness', 'N/A') }}%</strong>
                        </div>
                    </div>
                    
                    <!-- Readability -->
                    <div class="col-md-4">
                        <h6 class="border-bottom pb-2 mb-3">Readability</h6>
                        <div class="mb-2">
                            <small class="text-muted">Readability Score:</small><br>
                            <div class="progress mt-2" style="height: 20px;">
                                <div class="progress-bar {{ 'bg-success' if text_stats.get('readability_score', 100) < 40 else 'bg-warning' if text_stats.get('readability_score', 100) < 70 else 'bg-danger' }}" 
                                     role="progressbar" 
                                     style="width: {{ text_stats.get('readability_score', 0) }}%">
                                    {{ text_stats.get('readability_score', 'N/A') }}/100
                                </div>
                            </div>
                            <small class="text-muted d-block mt-1">
                                {% if text_stats.get('readability_score', 100) < 40 %}
                                    Easy to read
                                {% elif text_stats.get('readability_score', 100) < 70 %}
                                    Moderately complex
                                {% else %}
                                    Complex text
                                {% endif %}
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Document preview -->
        <div class="card analysis-card">
            <div class="card-header">
                <h5 class="mb-0">
                    <i class="fas fa-eye me-2"></i>Document Preview
                    <small class="text-muted">({{ analysis.original_text|length }} characters total)</small>
                </h5>
            </div>
            <div class="card-body">
                <pre class="bg-light p-3 rounded" style="max-height: 400px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.9em; line-height: 1.4; white-space: pre-wrap;">
{{ analysis.original_text | e }}
                </pre>
            </div>
        </div>
    </div>
</div>
{% endblock %}
